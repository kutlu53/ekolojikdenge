<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bir Canâ€™Ä±n GÃ¶zÃ¼nden DÃ¼nya - Oyun</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .panel {
            display: flex;
            justify-content: center;
            gap: 32px;
            background: #e6f2ff;
            padding: 18px 0 10px 0;
            border-bottom: 2px solid #b3d1ff;
        }
        .panel-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 120px;
        }
        .panel-label {
            font-weight: bold;
            color: #2e8b57;
        }
        .panel-value {
            margin-top: 4px;
            font-size: 1em;
            color: #444;
            background: #fff;
            border-radius: 6px;
            padding: 2px 10px;
        }
        .game-main {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 40px;
        }
        #uiRole {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 8px;
        }
        #uiSeason {
            font-size: 1.1em;
            color: #2e8b57;
            margin-bottom: 18px;
        }
        #sceneText {
            max-width: 600px;
            text-align: center;
            font-size: 1.15em;
            margin-bottom: 30px;
            background: #f9f9f9;
            border-radius: 8px;
            padding: 18px 24px;
            box-shadow: 0 2px 8px #0001;
        }
        #choices {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 40px;
        }
        .choice-btn {
            padding: 12px 28px;
            font-size: 1.1em;
            border: none;
            border-radius: 8px;
            background: #2e8b57;
            color: #fff;
            cursor: pointer;
            transition: background 0.2s;
        }
        .choice-btn:hover {
            background: #246b43;
        }
        /* Restart button styles moved to style.css */
    </style>
</head>
<body>
    <div class="panel">
        <div class="panel-item">
            <span class="panel-label">ğŸŒ¿ CanlÄ± Ã‡eÅŸitliliÄŸi</span>
            <div class="panel-indicator">
                <div class="stars-container" id="biyo-stars">â­â­â­â­â­</div>
                <div class="indicator-bar">
                    <div class="indicator-bar-fill" id="biyo-bar"></div>
                </div>
            </div>
            <span class="panel-value" id="biyo">MÃ¼kemmel</span>
        </div>
        <div class="panel-item">
            <span class="panel-label">ğŸ’§ Su Dengesi</span>
            <div class="panel-indicator">
                <div class="stars-container" id="su-stars">â­â­â­â­â­</div>
                <div class="indicator-bar">
                    <div class="indicator-bar-fill" id="su-bar"></div>
                </div>
            </div>
            <span class="panel-value" id="su">MÃ¼kemmel</span>
        </div>
        <div class="panel-item">
            <span class="panel-label">ğŸŒ± Toprak SaÄŸlÄ±ÄŸÄ±</span>
            <div class="panel-indicator">
                <div class="stars-container" id="toprak-stars">â­â­â­â­â­</div>
                <div class="indicator-bar">
                    <div class="indicator-bar-fill" id="toprak-bar"></div>
                </div>
            </div>
            <span class="panel-value" id="toprak">MÃ¼kemmel</span>
        </div>
        <div class="panel-item">
            <span class="panel-label">ğŸŒ¬ï¸ Hava/Ä°klim</span>
            <div class="panel-indicator">
                <div class="stars-container" id="hava-stars">â­â­â­â­â­</div>
                <div class="indicator-bar">
                    <div class="indicator-bar-fill" id="hava-bar"></div>
                </div>
            </div>
            <span class="panel-value" id="hava">MÃ¼kemmel</span>
        </div>
        <div class="panel-item">
            <span class="panel-label">ğŸ‘¥ Ä°nsan Etkisi</span>
            <div class="panel-indicator">
                <div class="stars-container" id="insan-stars">â­â­â­â­â­</div>
                <div class="indicator-bar">
                    <div class="indicator-bar-fill" id="insan-bar"></div>
                </div>
            </div>
            <span class="panel-value" id="insan">MÃ¼kemmel</span>
        </div>
    </div>
    <!-- Ä°lerleme Ã‡ubuÄŸu -->
    <div class="progress-container">
        <div class="progress-label">YÄ±l Ä°lerlemesi</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-seasons">
            <span class="season-marker" data-season="Ä°lkbahar">Ä°lkbahar</span>
            <span class="season-marker" data-season="Yaz">Yaz</span>
            <span class="season-marker" data-season="Sonbahar">Sonbahar</span>
            <span class="season-marker" data-season="KÄ±ÅŸ">KÄ±ÅŸ</span>
        </div>
    </div>
    <div class="game-main">
        <div id="uiRole">
            <span id="roleIcon">ğŸ</span>
            <span id="roleText">ArÄ±</span>
        </div>
        <div id="uiSeason">Ä°lkbahar</div>
        <div id="sceneText"></div>
        <div id="choices"></div>
    </div>
    <button class="restart-btn" id="restartBtn" title="Yeniden BaÅŸla">ğŸ”„</button>
    <button class="audio-toggle" id="audioToggle" title="Ses AÃ§/Kapat">ğŸ”Š</button>
    <button class="history-btn" id="historyBtn" title="Karar GeÃ§miÅŸi">ğŸ“œ</button>
    <button class="achievements-btn" id="achievementsBtn" title="BaÅŸarÄ± Rozetleri">ğŸ†</button>
    
    <!-- Karar GeÃ§miÅŸi Modal -->
    <div class="history-modal" id="historyModal">
        <div class="history-content">
            <h2>Karar GeÃ§miÅŸi</h2>
            <div id="historyList"></div>
            <button onclick="document.getElementById('historyModal').classList.remove('show')" style="margin-top: 16px; padding: 10px 20px; background: #2e8b57; color: white; border: none; border-radius: 8px; cursor: pointer;">Kapat</button>
        </div>
    </div>
    
    <!-- BaÅŸarÄ± Rozetleri Modal -->
    <div class="history-modal" id="achievementsModal">
        <div class="history-content">
            <h2>BaÅŸarÄ± Rozetleri</h2>
            <div id="achievementsList"></div>
            <button onclick="document.getElementById('achievementsModal').classList.remove('show')" style="margin-top: 16px; padding: 10px 20px; background: #2e8b57; color: white; border: none; border-radius: 8px; cursor: pointer;">Kapat</button>
        </div>
    </div>
    
    <script src="js/scenes.js"></script>
    <script src="js/engine.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/achievements.js"></script>
    <script src="js/history.js"></script>
    <script src="js/tooltips.js"></script>
    <script src="js/minigames.js"></script>
    <script src="js/season-animations.js"></script>
    <script src="js/magical-effects.js"></script>
    <script src="js/feedback.js"></script>
    <script src="js/ui.js"></script>
    <script>
      // Oyun baÅŸlatma
      window.addEventListener('DOMContentLoaded', function() {
        if (window.GameEngine && window.GameUI) {
          GameEngine.init();
          GameEngine.subscribe((state) => {
            const scene = GameEngine.getScene(state.currentSceneId);
            GameUI.render(state, scene);
          });
          // Ä°lk sahneyi gÃ¶ster
          const state = GameEngine.getState();
          const scene = GameEngine.getScene(state.currentSceneId);
          GameUI.render(state, scene);
          
          // MasalsÄ± efektleri baÅŸlat
          if (window.MagicalEffects) {
            window.MagicalEffects.init();
          }
          
          // Yeniden baÅŸlat butonu
          const restartBtn = document.getElementById('restartBtn');
          if (restartBtn) {
            restartBtn.onclick = function() {
              GameEngine.restart();
              const state = GameEngine.getState();
              const scene = GameEngine.getScene(state.currentSceneId);
              GameUI.render(state, scene);
            };
          }
          
          // Ses kontrol butonu
          const audioToggle = document.getElementById('audioToggle');
          if (audioToggle && window.AudioManager) {
            audioToggle.onclick = function() {
              const enabled = window.AudioManager.toggleAudio();
              audioToggle.textContent = enabled ? 'ğŸ”Š' : 'ğŸ”‡';
              audioToggle.classList.toggle('muted', !enabled);
            };
          }
          
          // Karar geÃ§miÅŸi butonu
          const historyBtn = document.getElementById('historyBtn');
          const historyModal = document.getElementById('historyModal');
          if (historyBtn && historyModal) {
            historyBtn.onclick = function() {
              const history = window.DecisionHistory ? window.DecisionHistory.get() : [];
              const list = document.getElementById('historyList');
              if (list) {
                if (history.length === 0) {
                  list.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">HenÃ¼z karar verilmedi.</p>';
                } else {
                  list.innerHTML = history.slice().reverse().map(decision => `
                    <div class="history-item">
                      <div class="history-season">${decision.season || 'Bilinmeyen'}</div>
                      <div class="history-text">${(decision.sceneText || '').substring(0, 100)}${(decision.sceneText || '').length > 100 ? '...' : ''}</div>
                      <div class="history-choice">${decision.choice ? decision.choice.label : 'SeÃ§im yapÄ±lmadÄ±'}</div>
                    </div>
                  `).join('');
                }
              }
              if (historyModal) {
                historyModal.classList.add('show');
              }
            };
          }
          
          // BaÅŸarÄ± rozetleri butonu
          const achievementsBtn = document.getElementById('achievementsBtn');
          const achievementsModal = document.getElementById('achievementsModal');
          if (achievementsBtn && achievementsModal) {
            achievementsBtn.onclick = function() {
              const achievements = window.AchievementSystem ? window.AchievementSystem.getAll() : [];
              const list = document.getElementById('achievementsList');
              if (list) {
                if (achievements.length === 0) {
                  list.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">HenÃ¼z baÅŸarÄ± rozeti yok.</p>';
                } else {
                  list.innerHTML = achievements.map(ach => `
                    <div class="history-item" style="${ach.earned ? '' : 'opacity: 0.5;'}">
                      <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 2em;">${ach.icon || 'ğŸ†'}</span>
                        <div style="flex: 1;">
                          <div style="font-weight: bold; margin-bottom: 4px;">${ach.name || 'BaÅŸarÄ±'}</div>
                          <div style="font-size: 0.9em; color: #666;">${ach.description || ''}</div>
                          ${ach.earned ? '<div style="font-size: 0.8em; color: #2e8b57; margin-top: 4px;">âœ“ KazanÄ±ldÄ±</div>' : '<div style="font-size: 0.8em; color: #999; margin-top: 4px;">KazanÄ±lmadÄ±</div>'}
                        </div>
                      </div>
                    </div>
                  `).join('');
                }
              }
              if (achievementsModal) {
                achievementsModal.classList.add('show');
              }
            };
          }
        }
      });
    </script>
  </body>
</html>
